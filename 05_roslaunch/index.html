
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Programming robots in ROS">
      
      
        <meta name="author" content="Tamas Levendovics">
      
      
        <link rel="canonical" href="https://abc-irobotics.github.io/ros_course_materials_en/05_roslaunch/">
      
      
        <link rel="prev" href="../04_da_vinci/">
      
      
        <link rel="next" href="../06_robotics_principles/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>ROS 2 Launch, Param, Bag - Programming robots in ROS</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
<meta name="google-site-verification" content="FvdynuQ7bWRSdFbJqOCTL5_UtXGGjBoTuHhiUGoEb7Q" />

  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#05-ros-2-launch-param-bag" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Programming robots in ROS" class="md-header__button md-logo" aria-label="Programming robots in ROS" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Programming robots in ROS
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ROS 2 Launch, Param, Bag
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="https://abc-irobotics.github.io/ros_course_materials_en/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="https://abc-irobotics.github.io/ros_course_materials_hu/" hreflang="hu" class="md-select__link">
              Hungarian
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../01_intro/" class="md-tabs__link">
          
  
  Materials

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../projects/" class="md-tabs__link">
        
  
    
  
  Projects

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Programming robots in ROS" class="md-nav__button md-logo" aria-label="Programming robots in ROS" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Programming robots in ROS
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Materials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Materials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01_intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02_linux_ros_principles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Linux and ROS principles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03_python_principles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Python principles, ROS Publisher, ROS Subscriber
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04_da_vinci/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Principles of robotics, da Vinci
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    5. Roslaunch, msg, action, service
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    5. Roslaunch, msg, action, service
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lecture" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ros-2-launch" class="md-nav__link">
    <span class="md-ellipsis">
      ROS 2 Launch
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ROS 2 Launch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    <span class="md-ellipsis">
      Usage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ros-2-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      ROS 2 Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ros-2-bag" class="md-nav__link">
    <span class="md-ellipsis">
      ROS 2 Bag
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#practice" class="md-nav__link">
    <span class="md-ellipsis">
      Practice
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Practice">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-launch-turtlesim-mimic" class="md-nav__link">
    <span class="md-ellipsis">
      1: Launch Turtlesim Mimic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-launch-turtlesim-goto" class="md-nav__link">
    <span class="md-ellipsis">
      2: Launch Turtlesim Goto
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-turtlesim-controller-params" class="md-nav__link">
    <span class="md-ellipsis">
      3: Turtlesim controller params
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bonus-1-turtlesim-controller-launch-and-substitutions" class="md-nav__link">
    <span class="md-ellipsis">
      Bonus 1: Turtlesim controller launch and substitutions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bonus-2-rosbag" class="md-nav__link">
    <span class="md-ellipsis">
      Bonus 2: Rosbag
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#useful-links" class="md-nav__link">
    <span class="md-ellipsis">
      Useful links
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06_robotics_principles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. Kinematics, inverse kinematics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07_git/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7. Versioning, Git
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../projects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Projects
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset"><a class="md-content__button md-icon" download href="05_roslaunch.pdf" title="PDF Export"><svg style="height: 1.2rem; width: 1.2rem;" viewBox="0 0 384 512" xmlns="http://www.w3.org/2000/svg"><path d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm76.45 211.36l-96.42 95.7c-6.65 6.61-17.39 6.61-24.04 0l-96.42-95.7C73.42 337.29 80.54 320 94.82 320H160v-80c0-8.84 7.16-16 16-16h32c8.84 0 16 7.16 16 16v80h65.18c14.28 0 21.4 17.29 11.27 27.36zM377 105L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9z"></path></svg></a>
                
                  


<h1 id="05-ros-2-launch-param-bag">05. ROS 2 Launch, Param, Bag</h1>
<hr />
<h2 id="lecture">Lecture</h2>
<hr />
<h3 id="ros-2-launch">ROS 2 Launch</h3>
<hr />
<ul>
<li>Launch multiple nodes</li>
<li>Set arguments</li>
<li>Monitor running nodes</li>
<li>React on changes in the state of nodes</li>
<li>Python, XML and YAML file formats</li>
</ul>
<hr />
<h4 id="usage">Usage</h4>
<div class="highlight"><pre><span></span><code><span class="w">    </span>ros2<span class="w"> </span>launch<span class="w"> </span>package_name<span class="w"> </span>file.launch
<span class="w">    </span>ros2<span class="w"> </span>launch<span class="w"> </span>irob_robot<span class="w"> </span>dvrk_server.launch<span class="w"> </span>arm_typ:<span class="o">=</span>PSM1
</code></pre></div>
<hr />
<h3 id="ros-2-parameters">ROS 2 Parameters</h3>
<hr />
<ul>
<li>Configure nodes at startup or during runtime without changing the code</li>
<li>Associated with individual nodes</li>
<li>Consists of: key, value, descriptor</li>
<li>Available data types: bool, int64, float64, string, byte[], bool[], int64[], float64[] or string[].</li>
<li>Useful command: <code>ros2 param</code></li>
</ul>
<hr />
<h3 id="ros-2-bag">ROS 2 Bag</h3>
<hr />
<ul>
<li>Record and playback ROS topics</li>
<li>Command line tool</li>
<li>API for C++ and Python</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="w">    </span>ros2<span class="w"> </span>bag<span class="w"> </span>record<span class="w"> </span>-o<span class="w"> </span>&lt;file_name&gt;<span class="w"> </span>&lt;topic_name&gt;
<span class="w">    </span>ros2<span class="w"> </span>bag<span class="w"> </span>record<span class="w"> </span>--all
<span class="w">    </span>ros2<span class="w"> </span>bag<span class="w"> </span>info<span class="w"> </span>&lt;filename.bag&gt;
<span class="w">    </span>ros2<span class="w"> </span>bag<span class="w"> </span>play<span class="w"> </span>&lt;filename.bag&gt;
</code></pre></div>
<hr />
<h2 id="practice">Practice</h2>
<hr />
<h3 id="1-launch-turtlesim-mimic">1: Launch Turtlesim Mimic</h3>
<hr />
<ol>
<li>
<p>Create the <code>launch</code> folder inside the <code>ros2_course</code> package,
   where the launch files can be stored:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/ros2_ws/src/ros2_course
mkdir<span class="w"> </span>launch
</code></pre></div>
<hr />
</li>
<li>
<p>Create the <code>turtlesim_mimic_launch.py</code> file in the new <code>launch</code> folder a
   with the following content:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">launch</span><span class="w"> </span><span class="kn">import</span> <span class="n">LaunchDescription</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">launch_ros.actions</span><span class="w"> </span><span class="kn">import</span> <span class="n">Node</span>

<span class="k">def</span><span class="w"> </span><span class="nf">generate_launch_description</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">LaunchDescription</span><span class="p">([</span>
        <span class="n">Node</span><span class="p">(</span>
            <span class="n">package</span><span class="o">=</span><span class="s1">&#39;turtlesim&#39;</span><span class="p">,</span>
            <span class="n">namespace</span><span class="o">=</span><span class="s1">&#39;turtlesim1&#39;</span><span class="p">,</span>
            <span class="n">executable</span><span class="o">=</span><span class="s1">&#39;turtlesim_node&#39;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;sim&#39;</span>
        <span class="p">),</span>
        <span class="n">Node</span><span class="p">(</span>
            <span class="n">package</span><span class="o">=</span><span class="s1">&#39;turtlesim&#39;</span><span class="p">,</span>
            <span class="n">namespace</span><span class="o">=</span><span class="s1">&#39;turtlesim2&#39;</span><span class="p">,</span>
            <span class="n">executable</span><span class="o">=</span><span class="s1">&#39;turtlesim_node&#39;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;sim&#39;</span>
        <span class="p">),</span>
        <span class="n">Node</span><span class="p">(</span>
            <span class="n">package</span><span class="o">=</span><span class="s1">&#39;turtlesim&#39;</span><span class="p">,</span>
            <span class="n">executable</span><span class="o">=</span><span class="s1">&#39;mimic&#39;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;mimic&#39;</span><span class="p">,</span>
            <span class="n">remappings</span><span class="o">=</span><span class="p">[</span>
                <span class="p">(</span><span class="s1">&#39;/input/pose&#39;</span><span class="p">,</span> <span class="s1">&#39;/turtlesim1/turtle1/pose&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s1">&#39;/output/cmd_vel&#39;</span><span class="p">,</span> <span class="s1">&#39;/turtlesim2/turtle1/cmd_vel&#39;</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">])</span>
</code></pre></div>
<hr />
</li>
<li>
<p>Add the followings to the <code>setup.py</code> file:</p>
<div class="highlight"><pre><span></span><code>import<span class="w"> </span>os
from<span class="w"> </span>glob<span class="w"> </span>import<span class="w"> </span>glob

<span class="c1"># ...</span>

<span class="nv">data_files</span><span class="o">=[</span>
<span class="w">    </span><span class="o">(</span><span class="s1">&#39;share/ament_index/resource_index/packages&#39;</span>,
<span class="w">        </span><span class="o">[</span><span class="s1">&#39;resource/&#39;</span><span class="w"> </span>+<span class="w"> </span>package_name<span class="o">])</span>,
<span class="w">    </span><span class="o">(</span><span class="s1">&#39;share/&#39;</span><span class="w"> </span>+<span class="w"> </span>package_name,<span class="w"> </span><span class="o">[</span><span class="s1">&#39;package.xml&#39;</span><span class="o">])</span>,
<span class="w">    </span><span class="c1"># Include all launch files.</span>
<span class="w">    </span><span class="o">(</span>os.path.join<span class="o">(</span><span class="s1">&#39;share&#39;</span>,<span class="w"> </span>package_name<span class="o">)</span>,
<span class="w">        </span>glob<span class="o">(</span><span class="s1">&#39;launch/*launch.[pxy][yma]*&#39;</span><span class="o">))</span>
<span class="o">]</span>,
</code></pre></div>
<hr />
</li>
<li>
<p>Add the <code>ros2launch</code> dependency to the <code>package.xml</code> file:</p>
<div class="highlight"><pre><span></span><code>&lt;exec_depend&gt;ros2launch&lt;/exec_depend&gt;
</code></pre></div>
<hr />
</li>
<li>
<p>Build the workspace:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>ros2_ws
colcon<span class="w"> </span>build<span class="w"> </span>--symlink-install
</code></pre></div>
<hr />
</li>
<li>
<p>Launch the launch file:</p>
<div class="highlight"><pre><span></span><code>ros2<span class="w"> </span>launch<span class="w"> </span>ros2_course<span class="w"> </span>turtlesim_mimic_launch.py
</code></pre></div>
<hr />
</li>
<li>
<p>Publish to the topic from the command line, in a new terminal window:</p>
<div class="highlight"><pre><span></span><code>ros2<span class="w"> </span>topic<span class="w"> </span>pub<span class="w"> </span>-r<span class="w"> </span><span class="m">1</span><span class="w"> </span>/turtlesim1/turtle1/cmd_vel<span class="w"> </span>geometry_msgs/msg/Twist<span class="w"> </span><span class="s2">&quot;{linear: {x: 2.0, y: 0.0, z: 0.0}, angular: {x: 0.0, y: 0.0, z: -1.8}}&quot;</span>
</code></pre></div>
<hr />
</li>
<li>
<p>Let's examine the operation of the system using <code>rqt_gui</code>:</p>
<div class="highlight"><pre><span></span><code>ros2<span class="w"> </span>run<span class="w"> </span>rqt_gui<span class="w"> </span>rqt_gui
</code></pre></div>
</li>
</ol>
<hr />
<h3 id="2-launch-turtlesim-goto">2: Launch Turtlesim Goto</h3>
<hr />
<ol>
<li>
<p>Let's make a copy of <code>turtlesim_mimic_launch.py</code>
   from a file named <code>turtlesim_controller_launch.py</code>.</p>
<hr />
</li>
<li>
<p>Add the <code>turtlesim_controller</code> node written in the previous lesson to the launch file, so the first turtle
is controlled by this node, and the second copies its movement.
The turtle to be controlled can be set using <code>namespace</code> or <code>remappings</code>.</p>
<hr />
</li>
<li>
<p>Build the workspace:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>ros2_ws
colcon<span class="w"> </span>build<span class="w"> </span>--symlink-install
</code></pre></div>
<hr />
</li>
<li>
<p>launch the new launch file:</p>
<div class="highlight"><pre><span></span><code>ros2<span class="w"> </span>launch<span class="w"> </span>ros2_course<span class="w"> </span>turtlesim_controller_launch.py
</code></pre></div>
<hr />
</li>
</ol>
<hr />
<h3 id="3-turtlesim-controller-params">3: Turtlesim controller params</h3>
<hr />
<ol>
<li>
<p>Modify <code>turtlesim_controller</code> so that the linear velocity and angular velocity.
   is adjustable via ROS parameters. API example for parameters:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">rclpy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">rclpy.node</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MinimalParam</span><span class="p">(</span><span class="n">rclpy</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">Node</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s1">&#39;minimal_param_node&#39;</span><span class="p">)</span>
        <span class="c1"># Declare parameter named &#39;my_parameter&#39; and</span>
        <span class="c1"># set default value to &#39;world&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">declare_parameter</span><span class="p">(</span><span class="s1">&#39;my_parameter&#39;</span><span class="p">,</span> <span class="s1">&#39;world&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_timer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">timer_callback</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">timer_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">my_param</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s1">&#39;my_parameter&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_parameter_value</span><span class="p">()</span><span class="o">.</span><span class="n">string_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Hello </span><span class="si">%s</span><span class="s1">!&#39;</span> <span class="o">%</span> <span class="n">my_param</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">rclpy</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
    <span class="n">node</span> <span class="o">=</span> <span class="n">MinimalParam</span><span class="p">()</span>
    <span class="n">rclpy</span><span class="o">.</span><span class="n">spin</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
<hr />
</li>
<li>
<p>Let's run <code>turtlesim_controller.py</code> using the previously written launch file.
   Let's list the parameters.</p>
<div class="highlight"><pre><span></span><code>ros2<span class="w"> </span>launch<span class="w"> </span>ros2_course<span class="w"> </span>turtlesim_controller_launch.py
</code></pre></div>
<div class="highlight"><pre><span></span><code>ros2<span class="w"> </span>param<span class="w"> </span>list
</code></pre></div>
<hr />
</li>
<li>
<p>Change the speed and angular velocity parameters from the command line using the following command:</p>
<div class="highlight"><pre><span></span><code>ros2<span class="w"> </span>param<span class="w"> </span><span class="nb">set</span><span class="w"> </span>&lt;NODE_NAME&gt;<span class="w"> </span>&lt;PARAM_NAME&gt;<span class="w"> </span>&lt;NEW_VALUE&gt;
ros2<span class="w"> </span>param<span class="w"> </span><span class="nb">set</span><span class="w"> </span>controller<span class="w"> </span>speed<span class="w"> </span><span class="m">100</span>.0
</code></pre></div>
</li>
</ol>
<hr />
<h3 id="bonus-1-turtlesim-controller-launch-and-substitutions">Bonus 1: Turtlesim controller launch and substitutions</h3>
<hr />
<ol>
<li>
<p>Let's make a copy of <code>turtlesim_controller_launch.py</code> as <code>turtlesim_controller_param_launch.py</code>.
   Modify the new launch file based on the example below so that the velocity and angular velocity parameters of the launch
   can be specified as file arguments.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">launch_ros.actions</span><span class="w"> </span><span class="kn">import</span> <span class="n">Node</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">launch</span><span class="w"> </span><span class="kn">import</span> <span class="n">LaunchDescription</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">launch.actions</span><span class="w"> </span><span class="kn">import</span> <span class="n">DeclareLaunchArgument</span><span class="p">,</span> <span class="n">ExecuteProcess</span><span class="p">,</span> <span class="n">TimerAction</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">launch.conditions</span><span class="w"> </span><span class="kn">import</span> <span class="n">IfCondition</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">launch.substitutions</span><span class="w"> </span><span class="kn">import</span> <span class="n">LaunchConfiguration</span><span class="p">,</span> <span class="n">PythonExpression</span>

<span class="k">def</span><span class="w"> </span><span class="nf">generate_launch_description</span><span class="p">():</span>

    <span class="n">turtlesim_ns_launch_arg</span> <span class="o">=</span> <span class="n">DeclareLaunchArgument</span><span class="p">(</span>
        <span class="s1">&#39;turtlesim_ns&#39;</span><span class="p">,</span>
        <span class="n">default_value</span><span class="o">=</span><span class="s1">&#39;turtlesim1&#39;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Namespace for turtle 1&#39;</span>
    <span class="p">)</span>
    <span class="n">use_provided_red_launch_arg</span> <span class="o">=</span> <span class="n">DeclareLaunchArgument</span><span class="p">(</span>
        <span class="s1">&#39;use_provided_red&#39;</span><span class="p">,</span>
        <span class="n">default_value</span><span class="o">=</span><span class="s1">&#39;False&#39;</span>
    <span class="p">)</span>
    <span class="n">new_background_r_launch_arg</span> <span class="o">=</span> <span class="n">DeclareLaunchArgument</span><span class="p">(</span>
        <span class="s1">&#39;new_background_r&#39;</span><span class="p">,</span>
        <span class="n">default_value</span><span class="o">=</span><span class="s1">&#39;200&#39;</span>
    <span class="p">)</span>
    <span class="n">background_g_launch_arg</span> <span class="o">=</span> <span class="n">DeclareLaunchArgument</span><span class="p">(</span>
        <span class="s1">&#39;background_g&#39;</span><span class="p">,</span>
        <span class="n">default_value</span><span class="o">=</span><span class="s1">&#39;100&#39;</span>
    <span class="p">)</span>
    <span class="n">background_b_launch_arg</span> <span class="o">=</span> <span class="n">DeclareLaunchArgument</span><span class="p">(</span>
        <span class="s1">&#39;background_b&#39;</span><span class="p">,</span>
        <span class="n">default_value</span><span class="o">=</span><span class="s1">&#39;100&#39;</span>
    <span class="p">)</span>

    <span class="n">turtlesim_ns_value</span> <span class="o">=</span> <span class="n">LaunchConfiguration</span><span class="p">(</span><span class="s1">&#39;turtlesim_ns&#39;</span><span class="p">)</span>
    <span class="n">use_provided_red_value</span> <span class="o">=</span> <span class="n">LaunchConfiguration</span><span class="p">(</span><span class="s1">&#39;use_provided_red&#39;</span><span class="p">)</span>
    <span class="n">new_background_r_value</span> <span class="o">=</span> <span class="n">LaunchConfiguration</span><span class="p">(</span><span class="s1">&#39;new_background_r&#39;</span><span class="p">)</span>
    <span class="n">background_g_value</span> <span class="o">=</span> <span class="n">LaunchConfiguration</span><span class="p">(</span><span class="s1">&#39;background_g&#39;</span><span class="p">)</span>
    <span class="n">background_b_value</span> <span class="o">=</span> <span class="n">LaunchConfiguration</span><span class="p">(</span><span class="s1">&#39;background_b&#39;</span><span class="p">)</span>

    <span class="n">turtlesim_node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span>
        <span class="n">package</span><span class="o">=</span><span class="s1">&#39;turtlesim&#39;</span><span class="p">,</span>
        <span class="n">namespace</span><span class="o">=</span><span class="n">turtlesim_ns_value</span><span class="p">,</span>
        <span class="n">executable</span><span class="o">=</span><span class="s1">&#39;turtlesim_node&#39;</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;sim&#39;</span><span class="p">,</span>
        <span class="n">parameters</span><span class="o">=</span><span class="p">[{</span>
            <span class="s1">&#39;background_g&#39;</span><span class="p">:</span> <span class="n">background_g_value</span><span class="p">,</span>
            <span class="s1">&#39;background_b&#39;</span><span class="p">:</span> <span class="n">background_b_value</span><span class="p">,</span>
        <span class="p">}]</span>
    <span class="p">)</span>
    <span class="n">spawn_turtle</span> <span class="o">=</span> <span class="n">ExecuteProcess</span><span class="p">(</span>
        <span class="n">cmd</span><span class="o">=</span><span class="p">[[</span>
            <span class="s1">&#39;ros2 service call &#39;</span><span class="p">,</span>
            <span class="n">turtlesim_ns</span><span class="p">,</span>
            <span class="s1">&#39;/spawn &#39;</span><span class="p">,</span>
            <span class="s1">&#39;turtlesim/srv/Spawn &#39;</span><span class="p">,</span>
            <span class="s1">&#39;&quot;{x: 2, y: 2, theta: 0.2}&quot;&#39;</span>
        <span class="p">]],</span>
        <span class="n">shell</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="n">change_background_r</span> <span class="o">=</span> <span class="n">ExecuteProcess</span><span class="p">(</span>
        <span class="n">cmd</span><span class="o">=</span><span class="p">[[</span>
            <span class="s1">&#39;ros2 param set &#39;</span><span class="p">,</span>
            <span class="n">turtlesim_ns</span><span class="p">,</span>
            <span class="s1">&#39;/sim background_r &#39;</span><span class="p">,</span>
            <span class="s1">&#39;120&#39;</span>
        <span class="p">]],</span>
        <span class="n">shell</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="n">change_background_r_conditioned</span> <span class="o">=</span> <span class="n">ExecuteProcess</span><span class="p">(</span>
        <span class="n">condition</span><span class="o">=</span><span class="n">IfCondition</span><span class="p">(</span>
            <span class="n">PythonExpression</span><span class="p">([</span>
                <span class="n">new_background_r_value</span><span class="p">,</span>
                <span class="s1">&#39; == 200&#39;</span><span class="p">,</span>
                <span class="s1">&#39; and &#39;</span><span class="p">,</span>
                <span class="n">use_provided_red</span>
            <span class="p">])</span>
        <span class="p">),</span>
        <span class="n">cmd</span><span class="o">=</span><span class="p">[[</span>
            <span class="s1">&#39;ros2 param set &#39;</span><span class="p">,</span>
            <span class="n">turtlesim_ns_value</span><span class="p">,</span>
            <span class="s1">&#39;/sim background_r &#39;</span><span class="p">,</span>
            <span class="n">new_background_r</span>
        <span class="p">]],</span>
        <span class="n">shell</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">LaunchDescription</span><span class="p">([</span>
        <span class="n">turtlesim_ns_launch_arg</span><span class="p">,</span>
        <span class="n">use_provided_red_launch_arg</span><span class="p">,</span>
        <span class="n">new_background_r_launch_arg</span><span class="p">,</span>
        <span class="n">turtlesim_node</span><span class="p">,</span>
        <span class="n">spawn_turtle</span><span class="p">,</span>
        <span class="n">change_background_r</span><span class="p">,</span>
        <span class="n">TimerAction</span><span class="p">(</span>
            <span class="n">period</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
            <span class="n">actions</span><span class="o">=</span><span class="p">[</span><span class="n">change_background_r_conditioned</span><span class="p">],</span>
        <span class="p">)</span>
    <span class="p">])</span>
</code></pre></div>
<hr />
</li>
<li>
<p>Build the workspace and run <code>turtlesim_controller_param_launch.py</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>ros2_ws
colcon<span class="w"> </span>build<span class="w"> </span>--symlink-install
ros2<span class="w"> </span>launch<span class="w"> </span>ros2_course<span class="w"> </span>turtlesim_controller_param_launch.py
</code></pre></div>
<hr />
</li>
<li>
<p>Let's list the arguments of the new launch file:</p>
<div class="highlight"><pre><span></span><code>ros2<span class="w"> </span>launch<span class="w"> </span>ros2_course<span class="w"> </span>turtlesim_controller_param_launch.py<span class="w"> </span>--show-args
</code></pre></div>
<hr />
</li>
<li>
<p>Run the launch file by setting the arguments:</p>
<div class="highlight"><pre><span></span><code>ros2<span class="w"> </span>launch<span class="w"> </span>ros2_course<span class="w"> </span>turtlesim_controller_param_launch.py<span class="w"> </span>speed:<span class="o">=</span><span class="m">100</span>.0<span class="w"> </span>omega:<span class="o">=</span><span class="m">60</span>.0
</code></pre></div>
<hr />
</li>
<li>
<p>Using the example above, let's set the background color also using command line argument(s).</p>
</li>
</ol>
<hr />
<h3 id="bonus-2-rosbag">Bonus 2: Rosbag</h3>
<hr />
<ol>
<li>
<p>While the program implemented in the previous exercise is running,
   record the contents of the topics in a rosbag file.</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span>ros2<span class="w"> </span>bag<span class="w"> </span>record<span class="w"> </span>--all
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Syntax</p>
<p>The filename and the topics to record can also be set, e.g.:</p>
</div>
<div class="highlight"><pre><span></span><code>ros2<span class="w"> </span>bag<span class="w"> </span>record<span class="w"> </span>-o<span class="w"> </span>turtle_bagfile_1<span class="w"> </span>/turtle1/cmd_vel<span class="w"> </span>/turtle1/pose
</code></pre></div>
<hr />
</li>
<li>
<p>Use the following command to query the properties of the bag file:</p>
<div class="highlight"><pre><span></span><code>ros2<span class="w"> </span>bag<span class="w"> </span>info<span class="w"> </span>&lt;PATH_TO_BAGFILE&gt;
</code></pre></div>
<hr />
</li>
<li>
<p>Play back the bag file and plot the <code>pose/x</code> value of one of the turtles on a graph using <code>rqt_gui</code>.</p>
<div class="highlight"><pre><span></span><code>ros2<span class="w"> </span>bag<span class="w"> </span>info<span class="w"> </span>&lt;PATH_TO_BAGFILE&gt;
</code></pre></div>
<div class="highlight"><pre><span></span><code>ros2<span class="w"> </span>run<span class="w"> </span>rqt_gui<span class="w"> </span>rqt_gui
</code></pre></div>
</li>
</ol>
<hr />
<h2 id="useful-links">Useful links</h2>
<ul>
<li><a href="https://docs.ros.org/en/foxy/Tutorials/Intermediate/Launch/Launch-Main.html">ROS 2 Launch Tutorial</a></li>
<li><a href="https://docs.ros.org/en/rolling/Concepts/About-ROS-2-Parameters.html">ROS 2 Parameters</a></li>
<li><a href="https://docs.ros.org/en/foxy/Tutorials/Beginner-Client-Libraries/Using-Parameters-In-A-Class-Python.html">Using ROS 2 parameters in a Class</a></li>
<li><a href="https://docs.ros.org/en/foxy/Tutorials/Beginner-CLI-Tools/Recording-And-Playing-Back-Data/Recording-And-Playing-Back-Data.html">ROS 2 Bag</a></li>
</ul>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 <a href="mailto:tamas.daniel.nagy@irob.uni-obuda.hu">Tamas D. Nagy</a>.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "toc.integrate"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.60a45f97.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://cdn.jsdelivr.net/gh/rod2ik/cdn@main/mkdocs/javascripts/mkdocs-graphviz.js"></script>
      
    
  </body>
</html>